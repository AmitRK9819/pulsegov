<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PulseGov - AI-Powered Civic Governance</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
      min-height: 100vh;
    }

    .glass-card {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 1rem;
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
    }

    .btn-primary {
      background: linear-gradient(to right, #0ea5e9, #0284c7);
      transition: all 0.3s;
    }

    .btn-primary:hover {
      transform: scale(1.05);
      box-shadow: 0 20px 40px -10px rgba(14, 165, 233, 0.5);
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .fade-in {
      animation: fadeIn 0.5s ease-out;
    }
  </style>
</head>

<body class="text-white">
  <div id="app" class="container mx-auto p-8">
    <!-- Landing Page -->
    <div id="landing" class="min-h-screen flex items-center justify-center">
      <div class="max-w-4xl w-full text-center fade-in">
        <div class="inline-block mb-6">
          <div
            class="w-20 h-20 bg-gradient-to-br from-blue-400 to-blue-600 rounded-2xl flex items-center justify-center shadow-2xl shadow-blue-500/50">
            <svg class="w-12 h-12 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
            </svg>
          </div>
        </div>

        <h1
          class="text-6xl font-bold mb-4 bg-gradient-to-r from-white via-blue-200 to-white bg-clip-text text-transparent">
          PulseGov
        </h1>
        <p class="text-2xl text-white/60 mb-4"></p>
        <p class="text-lg text-white/40 mb-2 max-w-2xl mx-auto">
        </p>
        <p class="text-sm text-yellow-400/80 mb-12"></p>

        <div class="grid md:grid-cols-2 gap-6 mb-12">
          <div onclick="showPage('login')"
            class="glass-card p-8 hover:scale-105 transition-transform cursor-pointer group">
            <div
              class="w-16 h-16 bg-gradient-to-br from-blue-400 to-blue-600 rounded-xl flex items-center justify-center mb-4 group-hover:shadow-2xl group-hover:shadow-blue-500/50 transition-all mx-auto">
              <svg class="w-8 h-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
              </svg>
            </div>
            <h3 class="text-2xl font-bold mb-2">Citizen Portal</h3>
            <p class="text-white/60 mb-2">Login to submit and track complaints</p>
            <div class="text-blue-400 text-sm font-semibold">Login ‚Üí</div>
          </div>

          <div onclick="showPage('officer')"
            class="glass-card p-8 hover:scale-105 transition-transform cursor-pointer group">
            <div
              class="w-16 h-16 bg-gradient-to-br from-green-400 to-green-600 rounded-xl flex items-center justify-center mb-4 group-hover:shadow-2xl group-hover:shadow-green-500/50 transition-all mx-auto">
              <svg class="w-8 h-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
              </svg>
            </div>
            <h3 class="text-2xl font-bold mb-2">Officer Dashboard</h3>
            <p class="text-white/60 mb-2"> SLA & Resolution Control Panel</p>
            <div class="text-green-400 text-sm font-semibold">Track, Act & Escalate Complaints ‚Üí</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Login Page -->
  <div id="login" class="hidden">
    <div class="max-w-md mx-auto fade-in">
      <div class="glass-card p-8">
        <h1
          class="text-3xl font-bold mb-6 text-center bg-gradient-to-r from-white via-blue-200 to-white bg-clip-text text-transparent">
          Citizen Login
        </h1>
        <form onsubmit="loginAccount(event)" class="space-y-4">
          <div>
            <label class="block text-sm font-medium mb-2">Username</label>
            <input type="text" id="login-username" required
              class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-blue-500 focus:outline-none"
              placeholder="Enter your username">
          </div>
          <div>
            <label class="block text-sm font-medium mb-2">Password</label>
            <input type="password" id="login-password" required
              class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-blue-500 focus:outline-none"
              placeholder="Enter your password">
          </div>
          <button type="submit" class="btn-primary w-full px-6 py-3 rounded-xl font-semibold">Login</button>
        </form>
        <div class="mt-6 text-center">
          <p class="text-white/60 text-sm mb-2">Don't have an account?</p>
          <button onclick="showPage('signup')" class="text-blue-400 hover:text-blue-300 font-semibold">Create New
            Account</button>
        </div>
        <div class="mt-4 text-center">
          <button onclick="showPage('landing')" class="text-blue-400 hover:text-blue-300 text-sm">‚Üê Back to
            Home</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Sign Up Page -->
  <div id="signup" class="hidden">
    <div class="max-w-md mx-auto fade-in">
      <div class="glass-card p-8">
        <h1
          class="text-3xl font-bold mb-6 text-center bg-gradient-to-r from-white via-blue-200 to-white bg-clip-text text-transparent">
          Create New Account
        </h1>
        <form onsubmit="createAccount(event)" class="space-y-4">
          <div>
            <label class="block text-sm font-medium mb-2">Username *</label>
            <input type="text" id="signup-username" required
              class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-blue-500 focus:outline-none"
              placeholder="Choose a unique username">
            <p class="text-xs text-white/40 mt-1">Must be unique</p>
          </div>
          <div>
            <label class="block text-sm font-medium mb-2">Email *</label>
            <input type="email" id="signup-email" required
              class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-blue-500 focus:outline-none"
              placeholder="your@email.com">
          </div>
          <div>
            <label class="block text-sm font-medium mb-2">Password *</label>
            <input type="password" id="signup-password" required
              class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-blue-500 focus:outline-none"
              placeholder="Create a strong password">
          </div>
          <div>
            <label class="block text-sm font-medium mb-2">Confirm Password *</label>
            <input type="password" id="signup-confirm" required
              class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-blue-500 focus:outline-none"
              placeholder="Confirm your password">
          </div>
          <button type="submit" class="btn-primary w-full px-6 py-3 rounded-xl font-semibold">Create Account</button>
        </form>
        <div class="mt-6 text-center">
          <button onclick="showPage('landing')" class="text-blue-400 hover:text-blue-300 text-sm">‚Üê Back to
            Home</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Citizen Portal -->
  <div id="citizen" class="hidden">
    <div class="max-w-6xl mx-auto fade-in">
      <div class="flex items-center justify-between mb-8">
        <div>
          <h1 class="text-4xl font-bold mb-2">Citizen Portal</h1>
          <p class="text-white/60">Track your civic grievances</p>
        </div>
        <button onclick="showPage('landing')" class="glass-card px-4 py-2 hover:bg-white/10 transition-all">‚Üê
          Back</button>
      </div>

      <button onclick="toggleForm()" id="newBtn" class="btn-primary px-6 py-3 rounded-xl font-semibold mb-6">
        + New Complaint
      </button>

      <button onclick="toggleComplaintsView()" id="viewBtn" class="btn-primary px-6 py-3 rounded-xl font-semibold mb-6">
        üëÅ View Complaints
      </button>

      <div id="complaintForm" class="glass-card p-8 mb-8 hidden">
        <h2 class="text-2xl font-bold mb-6">Submit New Complaint</h2>

        <form onsubmit="submitComplaint(event)" class="space-y-4">

          <!-- Name -->
          <div>
            <label class="block text-sm font-medium mb-2">Full Name *</label>
            <input type="text" id="name" required
              class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-blue-500 focus:outline-none"
              placeholder="Enter your full name">
          </div>

          <!-- Date -->
          <div>
            <label class="block text-sm font-medium mb-2">Date *</label>
            <input type="text" id="date" required placeholder="DD/MM/YYYY"
              class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-blue-500 focus:outline-none">
          </div>

          <!-- Department -->
          <div>
            <label class="block text-sm font-medium mb-2">Department *</label>
            <select id="department" required
              class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-blue-500 focus:outline-none">
              <option value="">Select Department</option>
              <option value="Electrical">Electrical</option>
              <option value="Hygiene">Hygiene</option>
              <option value="Others">Others</option>
            </select>
          </div>

          <!-- Description of Complaint -->
          <div>
            <label class="block text-sm font-medium mb-2">Description of Complaint *</label>
            <textarea id="complaintType" required rows="3"
              class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-blue-500 focus:outline-none"
              placeholder="Describe the complaint briefly"></textarea>
          </div>

          <!-- Aadhaar -->
          <div>
            <label class="block text-sm font-medium mb-2">Aadhaar Number *</label>
            <input type="text" id="aadhaar" required maxlength="14"
              class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-blue-500 focus:outline-none"
              placeholder="XXXX XXXX XXXX" oninput="formatAadhaar(this)">
          </div>

          <!-- Mobile -->
          <div>
            <label class="block text-sm font-medium mb-2">Mobile Number *</label>
            <input type="tel" id="mobile" required
              class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-blue-500 focus:outline-none"
              placeholder="10-digit mobile number">
          </div>

          <!-- Email -->
          <div>
            <label class="block text-sm font-medium mb-2">Email Address</label>
            <input type="email" id="email"
              class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-blue-500 focus:outline-none"
              placeholder="example@email.com">
          </div>

          <!-- Location -->
          <div class="grid grid-cols-2 gap-4">
            <div>
              <label class="block text-sm font-medium mb-2">City *</label>
              <input type="text" id="city" required
                class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white">
            </div>

            <div>
              <label class="block text-sm font-medium mb-2">District *</label>
              <input type="text" id="district" required
                class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white">
            </div>

            <div>
              <label class="block text-sm font-medium mb-2">State *</label>
              <input type="text" id="state" required
                class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white">
            </div>

            <div>
              <label class="block text-sm font-medium mb-2">Pincode *</label>
              <input type="text" id="pincode" required
                class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white">
            </div>
          </div>

          <button type="submit" class="btn-primary w-full px-6 py-3 rounded-xl font-semibold">
            Submit Complaint
          </button>

        </form>
      </div>


      <div id="complaintsList" class="hidden"></div>
    </div>
  </div>

  <!-- Officer Dashboard -->
  <div id="officer" class="hidden">
    <div class="max-w-7xl mx-auto fade-in">
      <div class="flex items-center justify-between mb-8">
        <div>
          <h1 class="text-4xl font-bold mb-2">Officer Dashboard</h1>
          <p class="text-white/60">ü§ñ AI-powered resolution intelligence at your fingertips</p>
        </div>
        <button onclick="showPage('landing')" class="glass-card px-4 py-2 hover:bg-white/10 transition-all">‚Üê
          Back</button>
      </div>

      <div class="grid lg:grid-cols-3 gap-8">
        <div class="lg:col-span-1">
          <div class="glass-card p-6">
            <h2 class="text-xl font-bold mb-4">Assigned Complaints (<span id="complaintCount">0</span>)
            </h2>
            <div id="officerComplaints" class="space-y-3 max-h-[600px] overflow-y-auto"></div>
          </div>
        </div>

        <div class="lg:col-span-2">
          <div id="complaintDetails" class="glass-card p-12 text-center h-full flex items-center justify-center">
            <div>
              <div class="text-6xl mb-4">üëà</div>
              <p class="text-white/60 text-lg">Select a complaint to view AI-powered resolution
                suggestions</p>
              <p class="text-white/40 text-sm mt-2">The killer feature that makes PulseGov unique!</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  </div>

  <script>
    // Mock Data
    let complaints = [];

    // Existing usernames for uniqueness check
    let existingUsernames = ['admin', 'user1', 'citizen', 'testuser'];

    let selectedComplaint = null;

    function showPage(page) {
      ['landing', 'citizen', 'officer', 'login', 'signup'].forEach(p => {
        document.getElementById(p).classList.add('hidden');
      });
      document.getElementById(page).classList.remove('hidden');

      if (page === 'citizen') loadCitizenComplaints();
      if (page === 'officer') loadOfficerComplaints();
    }

    function toggleForm() {
      document.getElementById('complaintForm').classList.toggle('hidden');
    }

    function toggleComplaintsView() {
      document.getElementById('complaintsList').classList.toggle('hidden');
      loadCitizenComplaints();
    }

    function formatAadhaar(input) {
      // Remove all non-digit characters
      let value = input.value.replace(/\D/g, '');
      // Limit to 12 digits
      value = value.slice(0, 12);
      // Add spaces after every 4 digits
      let formatted = value.replace(/(.{4})/g, '$1 ').trim();
      input.value = formatted;
    }

    function submitComplaint(e) {
      e.preventDefault();

      // Get values
      const name = document.getElementById('name').value.trim();
      const date = document.getElementById('date').value.trim();
      const aadhaar = document.getElementById('aadhaar').value.trim();
      const mobile = document.getElementById('mobile').value.trim();
      const pincode = document.getElementById('pincode').value.trim();

      // Name: only letters and spaces
      if (!/^[A-Za-z\s]+$/.test(name)) {
        alert('Name should only contain letters and spaces.');
        return;
      }

      // Date: DD/MM/YYYY
      if (!/^\d{2}\/\d{2}\/\d{4}$/.test(date)) {
        alert('Date must be in DD/MM/YYYY format.');
        return;
      }

      // Aadhaar: 12 digits, spaces after every 4 digits (e.g., 1234 5678 9012)
      if (!/^\d{4}\s\d{4}\s\d{4}$/.test(aadhaar)) {
        alert('Aadhaar number must be 12 digits with spaces after every 4 digits (e.g., 1234 5678 9012).');
        return;
      }

      // Mobile: exactly 10 digits
      if (!/^\d{10}$/.test(mobile)) {
        alert('Mobile number must be exactly 10 digits.');
        return;
      }

      // Pincode: only numbers (usually 6 digits in India)
      if (!/^\d+$/.test(pincode)) {
        alert('Pincode must contain only numbers.');
        return;
      }

      const newComplaint = {
        id: complaints.length + 1,
        complaint_id: `CMP-${Date.now()}-DEMO${String(complaints.length + 1).padStart(4, '0')}`,
        citizen_id: 1,
        title: document.getElementById('name').value, // Fixed: use 'name' field
        description: document.getElementById('complaintType').value,
        category: 'Pending Classification',
        status: 'pending',
        created_at: new Date().toISOString(),
      };

      complaints.push(newComplaint);

      // Clear form fields that actually exist
      document.getElementById('name').value = '';
      document.getElementById('date').value = '';
      document.getElementById('department').value = '';
      document.getElementById('complaintType').value = '';
      document.getElementById('aadhaar').value = '';
      document.getElementById('mobile').value = '';
      document.getElementById('email').value = '';
      document.getElementById('city').value = '';
      document.getElementById('district').value = '';
      document.getElementById('state').value = '';
      document.getElementById('pincode').value = '';
      toggleForm();

      alert(`‚úÖ Complaint submitted successfully!\n\nID: ${newComplaint.complaint_id}\n\nAI will classify and assign to an officer automatically.`);

      setTimeout(() => {
        const categories = [
          { cat: 'Streetlight Not Working', dept: 'Electricity', officer: 'Rajesh Kumar' },
          { cat: 'Pothole on Road', dept: 'Roads', officer: 'Amit Patel' },
          { cat: 'Garbage Not Collected', dept: 'Sanitation', officer: 'Priya Sharma' },
        ];
        const random = categories[Math.floor(Math.random() * categories.length)];
        newComplaint.category = random.cat;
        newComplaint.department = random.dept;
        newComplaint.officer = random.officer;
        newComplaint.status = 'assigned';
        loadCitizenComplaints();
      }, 1000);

      loadCitizenComplaints();
    }

    function createAccount(e) {
      e.preventDefault();
      const username = document.getElementById('signup-username').value.trim();
      const email = document.getElementById('signup-email').value.trim();
      const password = document.getElementById('signup-password').value;
      const confirm = document.getElementById('signup-confirm').value;

      if (!username || !email || !password || !confirm) {
        alert('Please fill in all fields.');
        return;
      }

      if (existingUsernames.includes(username.toLowerCase())) {
        alert('Username already exists. Please choose a different username.');
        return;
      }

      if (password !== confirm) {
        alert('Passwords do not match.');
        return;
      }

      if (password.length < 6) {
        alert('Password must be at least 6 characters long.');
        return;
      }

      // Add to existing usernames
      existingUsernames.push(username.toLowerCase());

      alert(`‚úÖ Account created successfully!\n\nWelcome, ${username}!`);

      // Reset form
      document.getElementById('signup-username').value = '';
      document.getElementById('signup-email').value = '';
      document.getElementById('signup-password').value = '';
      document.getElementById('signup-confirm').value = '';

      // Go to citizen portal
      showPage('citizen');
    }

    function loginAccount(e) {
      e.preventDefault();
      const username = document.getElementById('login-username').value.trim();
      const password = document.getElementById('login-password').value;

      if (!username || !password) {
        alert('Please enter both username and password.');
        return;
      }

      if (!existingUsernames.includes(username.toLowerCase())) {
        alert('Username not found. Please check your username or create a new account.');
        return;
      }

      // For demo purposes, any password works for existing users
      alert(`‚úÖ Welcome back, ${username}!`);

      // Reset form
      document.getElementById('login-username').value = '';
      document.getElementById('login-password').value = '';

      // Go to citizen portal
      showPage('citizen');
    }

    function loadCitizenComplaints() {
      const html = complaints.map(c => `
        <div class="glass-card p-6 hover:scale-[1.02] transition-transform mb-4">
          <div class="flex items-start justify-between mb-3">
            <div class="flex-1">
              <div class="flex items-center gap-3 mb-2">
                <h3 class="text-xl font-bold">${c.title}</h3>
                <span class="px-3 py-1 rounded-full text-xs font-medium ${getStatusBadge(c.status)}">${c.status.toUpperCase()}</span>
              </div>
              <p class="text-white/60 text-sm mb-1">ID: ${c.complaint_id}</p>
            </div>
          </div>
          <p class="text-white/80 mb-4">${c.description}</p>
          <div class="grid grid-cols-3 gap-4 pt-3 border-t border-white/10">
            <div>
              <p class="text-xs text-white/40 mb-1">Category</p>
              <p class="font-medium text-sm">${c.category || 'Classifying...'}</p>
            </div>
            <div>
              <p class="text-xs text-white/40 mb-1">Department</p>
              <p class="font-medium text-sm">${c.department || 'Pending'}</p>
            </div>
            <div>
              <p class="text-xs text-white/40 mb-1">Assigned To</p>
              <p class="font-medium text-sm">${c.officer || 'Routing...'}</p>
            </div>
          </div>
          ${c.resolution ? `
            <div class="mt-4 p-4 bg-green-500/10 border border-green-500/30 rounded-xl">
              <p class="text-xs text-green-400 font-medium mb-1">‚úì RESOLVED</p>
              <p class="text-white/80 text-sm">${c.resolution}</p>
            </div>
          ` : ''}
        </div>
      `).join('');

      document.getElementById('complaintsList').innerHTML = html || '<div class="glass-card p-12 text-center text-white/60">No complaints yet. Submit your first complaint!</div>';
    }

    function loadOfficerComplaints() {
      const assigned = complaints.filter(c => c.status === 'assigned');
      document.getElementById('complaintCount').textContent = assigned.length;

      const html = assigned.map(c => `
        <div onclick="selectComplaint(${c.id})" class="p-4 rounded-xl border cursor-pointer transition-all ${selectedComplaint?.id === c.id
          ? 'bg-blue-500/20 border-blue-500 shadow-lg shadow-blue-500/20'
          : 'bg-white/5 border-white/10 hover:bg-white/10'
        }">
          <p class="font-semibold text-sm mb-1 text-white/90">${c.complaint_id}</p>
          <p class="text-white/70 text-sm leading-tight">${c.title}</p>
          <p class="text-xs text-white/50 mt-2">${c.category}</p>
        </div>
      `).join('');

      document.getElementById('officerComplaints').innerHTML = html || '<p class="text-center text-white/40 py-12 text-sm">üéâ No pending complaints!</p>';
    }

    function selectComplaint(id) {
      selectedComplaint = complaints.find(c => c.id === id);
      loadOfficerComplaints();

      // Placeholder for AI suggestions (demo data removed)
      const suggestions = {
        actions: [
          'Assess the situation and gather relevant details',
          'Contact appropriate department for resolution',
          'Follow up with complainant after resolution',
          'Document the resolution process'
        ],
        time: 24,
        success: 85,
        cases: 0,
        similar_complaints: []
      };

      const html = `
        <div class="space-y-6 text-left">
          <div class="glass-card p-6">
            <div class="flex justify-between items-start mb-4">
              <div>
                <h2 class="text-2xl font-bold mb-2">${selectedComplaint.title}</h2>
                <p class="text-white/60 text-sm">ID: ${selectedComplaint.complaint_id}</p>
              </div>
              <button onclick="resolveComplaint()" class="btn-primary px-6 py-3 rounded-xl font-semibold whitespace-nowrap">‚úì Mark Resolved</button>
            </div>
            <p class="text-white/80 mb-4">${selectedComplaint.description}</p>
            <div class="grid grid-cols-3 gap-4 pt-4 border-t border-white/10">
              <div>
                <p class="text-xs text-white/40 mb-1">Category</p>
                <p class="font-medium text-sm">${selectedComplaint.category}</p>
              </div>
              <div>
                <p class="text-xs text-white/40 mb-1">Department</p>
                <p class="font-medium text-sm">${selectedComplaint.department}</p>
              </div>
              <div>
                <p class="text-xs text-white/40 mb-1">Submitted</p>
                <p class="font-medium text-sm">${new Date(selectedComplaint.created_at).toLocaleDateString()}</p>
              </div>
            </div>
          </div>

          <div class="glass-card p-6 border-2 border-blue-500/30 shadow-2xl shadow-blue-500/10">
            <div class="flex items-center gap-3 mb-6">
              <div class="w-12 h-12 bg-gradient-to-br from-blue-400 to-blue-600 rounded-xl flex items-center justify-center text-2xl shadow-lg shadow-blue-500/50">ü§ñ</div>
              <div>
                <h3 class="text-xl font-bold text-blue-400">AI Resolution Intelligence</h3>
                <p class="text-sm text-white/60">Powered by Neo4j Graph Database ‚Ä¢ ${suggestions.cases} similar cases analyzed</p>
              </div>
            </div>

            <div class="mb-6">
              <h4 class="font-semibold mb-3 text-green-400 flex items-center gap-2">
                <span class="text-lg">‚úì</span> Recommended Action Steps:
              </h4>
              <div class="space-y-2">
                ${suggestions.actions.map((action, i) => `
                  <div class="flex items-start gap-3 p-3 bg-green-500/10 border border-green-500/30 rounded-lg hover:bg-green-500/20 transition-all">
                    <span class="text-green-400 font-bold flex-shrink-0">${i + 1}.</span>
                    <p class="text-white/90 text-sm">${action}</p>
                  </div>
                `).join('')}
              </div>
            </div>

            <div class="grid grid-cols-3 gap-4 mb-6 p-4 bg-white/5 border border-white/10 rounded-xl">
              <div class="text-center">
                <p class="text-xs text-white/40 mb-1">Estimated Time</p>
                <p class="font-bold text-2xl text-blue-400">${suggestions.time}h</p>
              </div>
              <div class="text-center">
                <p class="text-xs text-white/40 mb-1">Success Rate</p>
                <p class="font-bold text-2xl text-green-400">${suggestions.success}%</p>
              </div>
              <div class="text-center">
                <p class="text-xs text-white/40 mb-1">Similar Cases</p>
                <p class="font-bold text-2xl text-yellow-400">${suggestions.cases}</p>
              </div>
            </div>

            <div>
              <h4 class="font-semibold mb-3 text-blue-400 flex items-center gap-2">
                <span class="text-lg">üîç</span> Historical Cases with Proven Solutions:
              </h4>
              <div class="space-y-3 max-h-80 overflow-y-auto pr-2">
                ${suggestions.similar_complaints.length > 0 ? suggestions.similar_complaints.map(sc => `
                  <div class="p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg hover:border-blue-500/40 transition-all">
                    <div class="flex justify-between items-start mb-2">
                      <p class="font-medium text-sm text-blue-300">${sc.id}</p>
                      <div class="text-right">
                        <span class="text-xs text-green-400 font-semibold">‚úì Resolved in ${sc.time}h</span>
                        <div class="text-xs text-yellow-400 mt-1">${sc.similarity}% similar</div>
                      </div>
                    </div>
                    <p class="text-sm text-white/80 mb-3 font-medium">${sc.title}</p>
                    <div class="p-3 bg-white/5 border border-white/10 rounded-lg">
                      <p class="text-xs text-white/50 mb-1 font-semibold">Successful Resolution:</p>
                      <p class="text-sm text-white/90">${sc.resolution}</p>
                    </div>
                    <div class="mt-2 flex justify-between items-center">
                      <div class="flex gap-1">
                        ${Array(sc.rating).fill('‚≠ê').join('')}
                      </div>
                      <span class="text-xs text-white/40">Officer rating: ${sc.rating}/5</span>
                    </div>
                  </div>
                `).join('') : `
                  <div class="p-4 bg-gray-500/10 border border-gray-500/20 rounded-lg text-center">
                    <p class="text-white/60">No historical cases available</p>
                    <p class="text-sm text-white/40 mt-1">AI suggestions will be available once more complaints are resolved</p>
                  </div>
                `}
              </div>
            </div>

            <div class="mt-6 p-4 bg-purple-500/10 border border-purple-500/30 rounded-xl">
              <p class="text-sm text-purple-300">
                <strong>üí° Why this works:</strong> These suggestions are generated from our Resolution Intelligence Network - 
                a graph database that learns from every resolved complaint. The system will analyze similar cases 
                and identify the most successful resolution patterns as more complaints are resolved.
              </p>
            </div>
          </div>
        </div>
      `;

      document.getElementById('complaintDetails').innerHTML = html;
    }

    function resolveComplaint() {
      const resolution = prompt('Enter resolution details (or press Cancel to use AI suggestion):');
      if (resolution === null) return;

      const finalResolution = resolution || 'Followed AI recommended steps. Issue resolved successfully.';
      selectedComplaint.status = 'resolved';
      selectedComplaint.resolution = finalResolution;

      alert('‚úÖ Complaint marked as resolved!\n\nThis resolution will be added to the graph database to help future officers.');

      selectedComplaint = null;
      loadOfficerComplaints();
      document.getElementById('complaintDetails').innerHTML = '<div class="glass-card p-12 text-center h-full flex items-center justify-center"><div><div class="text-6xl mb-4">üëà</div><p class="text-white/60 text-lg">Select a complaint to view AI suggestions</p></div></div>';
    }

    function getStatusBadge(status) {
      const badges = {
        pending: 'bg-yellow-500/20 text-yellow-400 border border-yellow-500/30',
        assigned: 'bg-blue-500/20 text-blue-400 border border-blue-500/30',
        in_progress: 'bg-purple-500/20 text-purple-400 border border-purple-500/30',
        resolved: 'bg-green-500/20 text-green-400 border border-green-500/30'
      };
      return badges[status] || 'bg-gray-500/20 text-gray-400';
    }

    // Initialize
    loadCitizenComplaints();
  </script>
</body>

</html>